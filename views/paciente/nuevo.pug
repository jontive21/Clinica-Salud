extends ../layout

block content
  h1 #{title} // El título se pasa desde el controlador, ej., "Registrar Nuevo Paciente"

  //- Mostrar errores de validación si existen (puede mejorarse luego)
  if errors && errors.length > 0
    div.alert.alert-danger.mt-3
      h4 Errores:
      ul
        each error in errors
          li= error.msg

  form(method="POST" action="/pacientes")
    div.form-group
      label(for="nombre") Nombre:
      input(type="text" id="nombre" name="nombre" required value=(pacienteData && pacienteData.nombre ? pacienteData.nombre : ''))

    div.form-group
      label(for="apellido") Apellido:
      input(type="text" id="apellido" name="apellido" required value=(pacienteData && pacienteData.apellido ? pacienteData.apellido : ''))

    div.form-group
      label(for="dni") DNI:
      input(type="text" id="dni" name="dni" required value=(pacienteData && pacienteData.dni ? pacienteData.dni : ''))

    div.form-group
      label(for="fechaNacimiento") Fecha de Nacimiento:
      input(type="date" id="fechaNacimiento" name="fechaNacimiento" required value=(pacienteData && pacienteData.fechaNacimiento ? pacienteData.fechaNacimiento : ''))
    
    div.form-group
      label(for="sexo") Sexo:
      select#sexo.form-control(name="sexo")
        option(value="") -- Seleccione Sexo --
        option(value="Masculino" selected=(pacienteData && pacienteData.sexo === 'Masculino')) Masculino
        option(value="Femenino" selected=(pacienteData && pacienteData.sexo === 'Femenino')) Femenino
        option(value="Otro" selected=(pacienteData && pacienteData.sexo === 'Otro')) Otro

    div.form-group
      label(for="telefono") Teléfono:
      input(type="tel" id="telefono" name="telefono" required value=(pacienteData && pacienteData.telefono ? pacienteData.telefono : ''))

    div.form-group
      label(for="email") Email:
      input(type="email" id="email" name="email" required value=(pacienteData && pacienteData.email ? pacienteData.email : ''))
      
    //- Campos básicos de dirección según documento HIS (Recepción y Registro de Datos)
    h4.mt-4 Dirección
    div.form-group
      label(for="domicilio") Domicilio:
      input(type="text" id="domicilio" name="domicilio" value=(pacienteData && pacienteData.domicilio ? pacienteData.domicilio : ''))

    div.form-group
      label(for="localidad") Localidad:
      input(type="text" id="localidad" name="localidad" value=(pacienteData && pacienteData.localidad ? pacienteData.localidad : ''))

    div.form-group
      label(for="provincia") Provincia:
      input(type="text" id="provincia" name="provincia" value=(pacienteData && pacienteData.provincia ? pacienteData.provincia : ''))

    div.form-group
      label(for="cp") Código Postal:
      input(type="text" id="cp" name="cp" value=(pacienteData && pacienteData.cp ? pacienteData.cp : ''))

    //- Campos de Seguro y Contacto de Emergencia
    h4.mt-4 Información Adicional
    div.form-group
      label(for="numero_seguro") Número de Seguro:
      input(type="text" id="numero_seguro" name="numero_seguro" value=(pacienteData && pacienteData.numero_seguro ? pacienteData.numero_seguro : '') class="form-control")
    
    div.form-group
      label(for="informacion_seguro") Información del Seguro:
      textarea#informacion_seguro.form-control(name="informacion_seguro" rows="3") #{pacienteData && pacienteData.informacion_seguro ? pacienteData.informacion_seguro : ''}

    div.form-group
      label(for="contacto_emergencia_nombre") Nombre Contacto Emergencia:
      input(type="text" id="contacto_emergencia_nombre" name="contacto_emergencia_nombre" value=(pacienteData && pacienteData.contacto_emergencia_nombre ? pacienteData.contacto_emergencia_nombre : '') class="form-control")

    div.form-group
      label(for="contacto_emergencia_telefono") Teléfono Contacto Emergencia:
      input(type="tel" id="contacto_emergencia_telefono" name="contacto_emergencia_telefono" value=(pacienteData && pacienteData.contacto_emergencia_telefono ? pacienteData.contacto_emergencia_telefono : '') class="form-control")

    button(type="submit" class="btn btn-primary mt-3") Registrar Paciente 
    a(href="/pacientes" class="btn btn-secondary mt-3 ml-2") Cancelar