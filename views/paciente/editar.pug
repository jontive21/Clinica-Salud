extends ../layout

block content
  h1 #{title}

  // Mostrar errores de validación si existen
  if errors && errors.length > 0
    div.alert.alert-danger.mt-3
      h5 Errores de Validación:
      ul
        each error in errors
          li= error.msg

  if paciente
    form(method="POST" action=`/pacientes/${paciente.id}/actualizar`)
      div.form-group.mb-3
        label(for="nombre") Nombre:
        input(type="text" id="nombre" name="nombre" value=paciente.nombre required class="form-control")

      div.form-group.mb-3
        label(for="apellido") Apellido:
        input(type="text" id="apellido" name="apellido" value=paciente.apellido required class="form-control")

      div.form-group.mb-3
        label(for="dni") DNI:
        input(type="text" id="dni" name="dni" value=paciente.dni required class="form-control")

      div.form-group.mb-3
        label(for="fechaNacimiento") Fecha de Nacimiento:
        input(type="date" id="fechaNacimiento" name="fechaNacimiento" value=paciente.fechaNacimiento ? new Date(paciente.fechaNacimiento).toISOString().split('T')[0] : '' required class="form-control")

      div.form-group.mb-3
        label(for="telefono") Teléfono:
        input(type="tel" id="telefono" name="telefono" value=paciente.telefono required class="form-control")

      div.form-group.mb-3
        label(for="email") Email:
        input(type="email" id="email" name="email" value=paciente.email required class="form-control")

      div.form-group.mb-3
        label(for="sexo") Sexo:
        select#sexo.form-select(name="sexo" class="form-control") // Usar form-select si es BS5
          option(value="" selected=!paciente.sexo) -- Seleccione Sexo --
          option(value="Masculino" selected=paciente.sexo === 'Masculino') Masculino
          option(value="Femenino" selected=paciente.sexo === 'Femenino') Femenino
          option(value="Otro" selected=paciente.sexo === 'Otro') Otro

      div.form-group.mb-3
        label(for="numero_seguro") Número de Seguro:
        input(type="text" id="numero_seguro" name="numero_seguro" value=paciente.numero_seguro || '' class="form-control")

      div.form-group.mb-3
        label(for="informacion_seguro") Información del Seguro:
        textarea#informacion_seguro.form-control(name="informacion_seguro" rows="3") #{paciente.informacion_seguro || ''}

      div.form-group.mb-3
        label(for="contacto_emergencia_nombre") Nombre de Contacto de Emergencia:
        input(type="text" id="contacto_emergencia_nombre" name="contacto_emergencia_nombre" value=paciente.contacto_emergencia_nombre || '' class="form-control")

      div.form-group.mb-3
        label(for="contacto_emergencia_telefono") Teléfono de Contacto de Emergencia:
        input(type="tel" id="contacto_emergencia_telefono" name="contacto_emergencia_telefono" value=paciente.contacto_emergencia_telefono || '' class="form-control")

      div.form-group.mb-3
        label(for="domicilio") Domicilio:
        input(type="text" id="domicilio" name="domicilio" value=paciente.domicilio || '' class="form-control")

      div.form-group.mb-3
        label(for="localidad") Localidad:
        input(type="text" id="localidad" name="localidad" value=paciente.localidad || '' class="form-control")

      div.form-group.mb-3
        label(for="provincia") Provincia:
        input(type="text" id="provincia" name="provincia" value=paciente.provincia || '' class="form-control")

      div.form-group.mb-3
        label(for="cp") Código Postal:
        input(type="text" id="cp" name="cp" value=paciente.cp || '' class="form-control")

      button(type="submit" class="btn btn-primary mt-3") Actualizar Paciente

  else
    p.mt-3.alert.alert-warning Datos del paciente no disponibles para editar.

  hr
  a(href="/pacientes" class="btn btn-secondary mt-3") Cancelar y Volver a la Lista
```
